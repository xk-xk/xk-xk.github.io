(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{423:function(t,s,a){"use strict";a.r(s);var n=a(25),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"èµ„ç¼˜ç½‘ä¸»ç«™-ssr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#èµ„ç¼˜ç½‘ä¸»ç«™-ssr"}},[t._v("#")]),t._v(" èµ„ç¼˜ç½‘ä¸»ç«™(SSR)")]),t._v(" "),a("h2",{attrs:{id:"é¡¹ç›®ç»“æ„è¯´æ˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é¡¹ç›®ç»“æ„è¯´æ˜"}},[t._v("#")]),t._v(" é¡¹ç›®ç»“æ„è¯´æ˜")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("build")]),t._v(" "),a("ul",[a("li",[t._v("setup-dev-server.js")]),t._v(" "),a("li",[t._v("utils.js")]),t._v(" "),a("li",[t._v("vue-loader.conf.js")]),t._v(" "),a("li",[t._v("webpack.base.config.js")]),t._v(" "),a("li",[t._v("webpack.client.config.js  // é’ˆå¯¹å®¢æˆ·ç«¯ï¼ˆclient-manifestï¼‰çš„webpacké…ç½®")]),t._v(" "),a("li",[t._v("webpack.server.config.js // é’ˆå¯¹æœåŠ¡ç«¯ï¼ˆserver-bundleï¼‰çš„webpacké…ç½®")])])]),t._v(" "),a("li",[a("p",[t._v("config")]),t._v(" "),a("ul",[a("li",[t._v("dev.env.js")]),t._v(" "),a("li",[t._v("index.js")]),t._v(" "),a("li",[t._v("prod.env.js")])])]),t._v(" "),a("li",[a("p",[t._v("src")]),t._v(" "),a("ul",[a("li",[t._v("...")])]),t._v(" "),a("ul",[a("li",[t._v("app.js // åº”ç”¨å®ä¾‹ï¼ˆå¿…é¡»å·¥å‚æ¨¡å¼ï¼‰")]),t._v(" "),a("li",[t._v("App.vue // åº”ç”¨å®ä¾‹æ¨¡æ¿")]),t._v(" "),a("li",[t._v("entry-client.js // å®¢æˆ·ç«¯å…¥å£æ–‡ä»¶")]),t._v(" "),a("li",[t._v("entry-server.js // æœåŠ¡ç«¯å…¥å£æ–‡ä»¶")]),t._v(" "),a("li",[t._v("index.template.html // é™æ€é¡µé¢æ¨¡æ¿ï¼ˆæ¸²æŸ“æ¨¡æ¿ï¼‰")]),t._v(" "),a("li",[t._v("store // çŠ¶æ€ç®¡ç†ï¼ˆå¿…é¡»å·¥å‚æ¨¡å¼ï¼‰")]),t._v(" "),a("li",[t._v("router // è·¯ç”±ç®¡ç†ï¼ˆå¿…é¡»å·¥å‚æ¨¡å¼ï¼‰")])])]),t._v(" "),a("li",[a("p",[t._v("static")]),t._v(" "),a("ul",[a("li",[t._v("...")])])]),t._v(" "),a("li",[a("p",[t._v("package.json // ä¾èµ–é…ç½®ï¼Œnpmå‘½ä»¤é…ç½®")])]),t._v(" "),a("li",[a("p",[t._v("server.js // nodeæœåŠ¡å¯åŠ¨ç¨‹åº")])])]),t._v(" "),a("blockquote",[a("p",[t._v("å¤‡æ³¨ï¼šåŸSPAåº”ç”¨å·¥ç¨‹çš„å…¥å£æ–‡ä»¶main.jsä»¥åŠé™æ€æ¨¡æ¿index.htmléƒ½å·²åˆ é™¤ï¼Œmain.jsçš„åº”ç”¨å®ä¾‹é…ç½®è½¬è‡³app.js")])]),t._v(" "),a("blockquote",[a("p",[t._v("main.jså……å½“çš„åº”ç”¨å…¥å£è½¬è‡³entry-client.js,è¯·æ³¨æ„åŒºåˆ†å¹¶åˆç†ä½¿ç”¨ã€‚")])]),t._v(" "),a("h2",{attrs:{id:"package-jsonæ ¸å¿ƒä¾èµ–ä¸ç»„ä»¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#package-jsonæ ¸å¿ƒä¾èµ–ä¸ç»„ä»¶"}},[t._v("#")]),t._v(" package.jsonæ ¸å¿ƒä¾èµ–ä¸ç»„ä»¶")]),t._v(" "),a("ul",[a("li",[t._v("compression")]),t._v(" "),a("li",[t._v("cross-env")]),t._v(" "),a("li",[t._v("es6-promise")]),t._v(" "),a("li",[t._v("express // node express")]),t._v(" "),a("li",[t._v("extract-text-webpack-plugin")]),t._v(" "),a("li",[t._v("lru-cache // ç»„ä»¶çº§ç¼“å­˜")]),t._v(" "),a("li",[t._v("route-cache // è·¯ç”±ç¼“å­˜")]),t._v(" "),a("li",[t._v("serve-favicon // å¤„ç†favicon")]),t._v(" "),a("li",[t._v("vue //vueæ ¸å¿ƒ")]),t._v(" "),a("li",[t._v("vue-router // è·¯ç”±")]),t._v(" "),a("li",[t._v("vue-server-renderer // SSRæ¸²æŸ“æ ¸å¿ƒï¼ˆç‰ˆæœ¬è¯·ä¸vueä¿æŒä¸€è‡´ï¼‰")]),t._v(" "),a("li",[t._v("vuex // çŠ¶æ€ç®¡ç†")]),t._v(" "),a("li",[t._v("vuex-router-sync // è·¯ç”±-çŠ¶æ€åŒæ­¥")]),t._v(" "),a("li",[t._v("vue-client-only //æ ¸æ­¦å™¨ï¼Œä¸“é—¨ç”¨æ¥å¤„ç†ä¸æ”¯æŒSSRçš„ç»„ä»¶")])]),t._v(" "),a("h2",{attrs:{id:"app-js-ç‰¹åˆ«è¯´æ˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#app-js-ç‰¹åˆ«è¯´æ˜"}},[t._v("#")]),t._v(" app.js ç‰¹åˆ«è¯´æ˜")]),t._v(" "),a("h4",{attrs:{id:"ä½¿ç”¨å·¥å‚æ¨¡å¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨å·¥å‚æ¨¡å¼"}},[t._v("#")]),t._v(" ä½¿ç”¨å·¥å‚æ¨¡å¼")]),t._v(" "),a("p",[t._v("app.jså¯è§†ä¸ºSPAä¸‹çš„main.jsæ–‡ä»¶ï¼Œä½†æ³¨æ„è¿™ä¸¤è€…å¹¶ä¸ç­‰åŒ"),a("br"),t._v("\nå¯åœ¨app.jsä¸­è¿›è¡Œä¸main.jsç±»ä¼¼çš„é…ç½®æ–¹æ³•ï¼Œä½†ä¸åŒçš„æ˜¯app.jsæä¾›äº†ä¸€ä¸ªåˆ›å»ºVueå®ä¾‹çš„å·¥å‚å‡½æ•°ï¼Œè€Œéç›´æ¥å¯¼å‡ºä¸€ä¸ªVueå®ä¾‹")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createApp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("h")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("App"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" store "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("createAPP()å°†ä¼šåœ¨entry-client,entry-serverä¸­è¢«æŒ‡å®šä½¿ç”¨ï¼Œå…·ä½“æ„é€ å‡½æ•°è¯·è‡ªè¡Œé˜…è¯»æºä»£ç ")]),t._v(" "),a("blockquote",[a("p",[t._v("ä½¿ç”¨å·¥å‚æ¨¡å¼æ˜¯ä¸ºäº†é¿å…çŠ¶æ€å•ä¾‹ï¼ˆåœ¨æœåŠ¡ç«¯æ¸²æŸ“æ¨¡å¼ä¸‹ï¼ŒæœåŠ¡ç«¯éœ€è¦ä¸ºæ¯ä¸€ä¸ªè®¿é—®è€…åˆ›å»ºç‹¬ç«‹çš„åº”ç”¨å®ä¾‹ï¼‰")])]),t._v(" "),a("h4",{attrs:{id:"çŠ¶æ€ä¸è·¯ç”±åŒæ­¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#çŠ¶æ€ä¸è·¯ç”±åŒæ­¥"}},[t._v("#")]),t._v(" çŠ¶æ€ä¸è·¯ç”±åŒæ­¥")]),t._v(" "),a("p",[t._v("æœåŠ¡ç«¯æ¸²æŸ“ä¸‹ï¼ŒæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯éœ€è¦ä¿æŒè·¯ç”±çš„åŒæ­¥ï¼Œæˆ‘ä»¬ä½¿ç”¨storeé…åˆrouteræ¥è¾¾åˆ°æ­¤ç›®çš„")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" sync "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vuex-router-sync'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createApp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"store-ç‰¹åˆ«è¯´æ˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#store-ç‰¹åˆ«è¯´æ˜"}},[t._v("#")]),t._v(" store ç‰¹åˆ«è¯´æ˜")]),t._v(" "),a("p",[t._v("åŒæ ·ä»¥å·¥å‚æ¨¡å¼åˆ›å»ºstore")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createStore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vuex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Store")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    modules"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    getters"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"ä½¿ç”¨è¯´æ˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨è¯´æ˜"}},[t._v("#")]),t._v(" ä½¿ç”¨è¯´æ˜")]),t._v(" "),a("p",[t._v("ç”±äºåœ¨å…¥å£æ–‡ä»¶ä¸­å·²ç»å°†storeæ³¨å…¥åˆ°Vueæ‰€æœ‰çš„componentä¸­ï¼Œå› æ­¤åœ¨é¡µé¢æˆ‘ä»¬ä½¿ç”¨storeçš„æ–¹å¼ä¸ä»¥å¾€ç›¸åŒ")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computed")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mapState")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'count'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("foo\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mounted")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getters "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dispatch "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ä½†æ˜¯åœ¨jsæ–‡ä»¶ä¸­ï¼Œåˆ™æ— æ³•é€šè¿‡ç›´æ¥å¼•å…¥ä»¥ä½¿ç”¨store")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// xxx.js")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" store "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./store/index.js'")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ä»¥ä¸Šçš„ä»£ç æ‰§è¡Œå°†ä¼šæŠ¥é”™ï¼Œè¿™æ˜¯å› ä¸ºåœ¨SPAä¸‹index.jså½“å‰åº”ç”¨çš„storeå®ä¾‹ï¼Œè€Œåœ¨SSRæ¨¡å¼ä¸‹index.jsä»…ä»…åˆ›å»ºäº†ä¸€ä¸ªå·¥å‚å‡½æ•°\næ­£ç¡®çš„ä½¿ç”¨æ–¹æ³•æ˜¯åœ¨å‡½æ•°è°ƒç”¨å¤„ä¼ å…¥å½“å‰çš„storeå®ä¾‹")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// xxx.js")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// import store from './store/index.js'")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("store")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// xxx.vue")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" getUser "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xxx.js'")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  methods"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"ç»‘å®šåˆ°window"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç»‘å®šåˆ°window"}},[t._v("#")]),t._v(" ç»‘å®šåˆ°window")]),t._v(" "),a("p",[t._v("ä¸Šé¢çš„ä»£ç å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†çœ‹èµ·æ¥ä¼¼ä¹å¾ˆéº»çƒ¦ï¼Œå¹¶ä¸”å¯¹äºæˆ‘ä»¬æ”¹é€ çš„è°ƒæ•´é‡å¾ˆå¤§ï¼Œä½†æ˜¯æˆ‘ä»¬å¿…é¡»ç¡®ä¿è°ƒç”¨çš„store/routerå±äºå½“å‰çš„APPå®ä¾‹"),a("br"),t._v("\nåˆæˆ–è€…æˆ‘ä»¬åœ¨entry-client.jsé‡Œé¢å°†store,routerä¸windowè¿›è¡Œç»‘å®š")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createdApp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("store "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" store\n  window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("router "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" router\n")])])]),a("p",[t._v("è¿™æ ·å°±èƒ½å°±jsä¸­è¿™æ ·ä½¿ç”¨")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é»˜è®¤contextæ˜¯window")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// return window.store.state.user // æˆ–è€…æ›´ç›´è§‚çš„ä½¿ç”¨window.store")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("åŒæ ·éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæœåŠ¡ç«¯æ²¡æœ‰windowå¯¹è±¡ï¼Œæ‰€ä»¥è¯·åœ¨ç¼–å†™windowç›¸å…³çš„ä»£ç è¯­å¥æ—¶ç¡®ä¿ä¸ä¼šè¢«æœåŠ¡ç«¯æ‰€æ‰§è¡Œã€‚")])]),t._v(" "),a("h4",{attrs:{id:"æƒ°æ€§æ³¨å†Œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æƒ°æ€§æ³¨å†Œ"}},[t._v("#")]),t._v(" æƒ°æ€§æ³¨å†Œ")]),t._v(" "),a("p",[t._v("å½“éœ€è¦åˆ›å»ºä¸€ä¸ªæ¨¡å—çš„å¤šä¸ªå®ä¾‹ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªçº¯å¯¹è±¡æ¥å£°æ˜æ¨¡å—çš„çŠ¶æ€ï¼Œé‚£ä¹ˆè¿™ä¸ªçŠ¶æ€å¯¹è±¡ä¼šé€šè¿‡å¼•ç”¨è¢«å…±äº«ï¼Œå¯¼è‡´çŠ¶æ€å¯¹è±¡è¢«ä¿®æ”¹æ—¶ store æˆ–æ¨¡å—é—´æ•°æ®äº’ç›¸æ±¡æŸ“çš„é—®é¢˜ã€‚é€šè¿‡å·¥å‚æ¨¡å¼æˆ‘ä»¬ä¸ºæ¯ä¸ªAPPå®ä¾‹åˆ›å»ºäº†ç‹¬ç«‹çš„storeä»¥é¿å…è¿™ä¸ªé—®é¢˜ï¼Œä½†æˆ‘ä»¬ä»ç„¶å»ºè®®é‡‡ç”¨æƒ°æ€§æ³¨å†Œ(lazy-register)å°†è¿™äº›æ¨¡å—åˆ†å‰²åˆ°å¯¹åº”çš„è·¯ç”±chunkå½“ä¸­"),a("br"),t._v("\nå¯¹äºå¤§å‹çš„åº”ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†storeæ‹†åˆ†æˆå¤šä¸ªæ¨¡å—ï¼Œä¾‹å¦‚"),a("br")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user.js")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// product.js")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" userModules "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./user.js'")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerModule")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("userModules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("destoryed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("unregister")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"è®¿é—®ç‰¹å®šå¹³å°api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è®¿é—®ç‰¹å®šå¹³å°api"}},[t._v("#")]),t._v(" è®¿é—®ç‰¹å®šå¹³å°API")]),t._v(" "),a("p",[t._v("ç”±äºæœåŠ¡ç«¯ç¯å¢ƒä¸‹æ²¡æœ‰windowä»¥åŠdocumentï¼Œå¿…é¡»å°†è¿™ä¸¤ä¸ªå¯¹è±¡çš„ç›¸å…³APIè¿ç§»åˆ°å®¢æˆ·ç«¯ä¸‹æ‰§è¡Œ"),a("br"),t._v("\næˆ–è€…åœ¨æ‰§è¡Œå‰æ£€æŸ¥è¿è¡Œç¯å¢ƒ")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("VUE_ENV")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'client'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("localStorage "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"ssræ¨¡å¼ä¸‹ç”Ÿå‘½å‘¨æœŸç‰¹åˆ«è¯´æ˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssræ¨¡å¼ä¸‹ç”Ÿå‘½å‘¨æœŸç‰¹åˆ«è¯´æ˜"}},[t._v("#")]),t._v(" SSRæ¨¡å¼ä¸‹ç”Ÿå‘½å‘¨æœŸç‰¹åˆ«è¯´æ˜")]),t._v(" "),a("p",[t._v("åœ¨SSRä¸‹ï¼ŒVueçš„ä¸¤ä¸ªé‡è¦ç”Ÿå‘½å‘¨æœŸé’©å­:beforeMounted mountedåªä¼šåœ¨å®¢æˆ·ç«¯æ‰§è¡Œ"),a("br"),t._v("\nä¸ºäº†é¿å…Ajaxè¯·æ±‚åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é‡å¤è¯·æ±‚ï¼Œè¯·å°†Ajaxè¯·æ±‚è¿ç§»åˆ°mountedé’©å­å‡½æ•°ä¸­")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// created ç­‰é’©å­æ—¢èƒ½åœ¨æœåŠ¡ç«¯è§¦å‘ï¼Œä¹Ÿä¼šåœ¨å®¢æˆ·ç«¯æ‰§è¡Œï¼Œè¯·ç¡®ä¿å½“å‰åŠŸèƒ½çš„å¿…è¦æ€§åˆç†æ‹†åˆ†ä»£ç ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¾‹å¦‚ï¼šåœ¨SPAä¸‹ä¸€èˆ¬çš„Ajaxè¯·æ±‚åœ¨createdæˆ–è€…mountedä¸­æ‰§è¡Œå¹¶ä¸å½±å“ä»€ä¹ˆï¼Œä½†åœ¨SSRæ¨¡å¼ä¸‹åˆ™æ˜¾å¾—å¾ˆé‡è¦")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æˆ‘ä»¬å°†è¯·æ±‚ç§»åŠ¨åˆ°mountedä¸‹ï¼Œè®©è¯¥è¯·æ±‚åªåœ¨å®¢æˆ·ç«¯ä¸‹æ‰§è¡Œï¼Œåˆ™æœ‰æ•ˆèŠ‚çœäº†æœåŠ¡ç«¯çš„èµ„æºï¼ˆå› ä¸ºå¯¹æœåŠ¡ç«¯æ¥è®²æ‰§è¡Œæ­¤æ¬¡è¯·æ±‚æ˜¯å®Œå…¨æ²¡æœ‰å¿…è¦çš„ï¼‰")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å†ä¾‹å¦‚å¯¹äºç‰¹å®šå¹³å°çš„APIè‹¥æ”¾åœ¨createdé’©å­ä¸‹ï¼ŒæœåŠ¡ç«¯æ‰§è¡Œä¼šå‡ºé”™ï¼Œæˆ‘ä»¬ä¹Ÿå°†å…¶ç§»åŠ¨åˆ°åªä¼šåœ¨å®¢æˆ·ç«¯æ‰§è¡Œçš„é’©å­å‡½æ•°ä¸‹")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¹¶ä¸”ï¼ï¼ï¼åœ¨createdé‡Œé¢è°ƒç”¨å‡½æ•°æœ¬èº«ä¹Ÿæ˜¯ä¸å…·è§„èŒƒçš„ä¸€ä»¶äº‹ï¼ï¼")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// created () {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   this.fetchInfo(params).then(res =>{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   })")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   window.localStorage ... // æœåŠ¡ç«¯å°†ä¼šæŠ¥é”™")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   document.cookie ...  // æœåŠ¡ç«¯å°†ä¼šæŠ¥é”™")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   å¦‚æœä¸å¾—ä¸åœ¨æ­¤å¤„è®¿é—®ç‰¹å®šå¹³å°APIï¼Œéœ€è¦é¢„å…ˆæ£€æŸ¥è¿è¡Œç¯å¢ƒ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   if (process.env.VUE_ENV === 'client'){")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      window.localStorage ... // æ‰§è¡Œç¯å¢ƒæ£€æŸ¥åè¯¥ä»£ç ä»…ä¼šåœ¨å®¢æˆ·ç«¯æ‰§è¡Œ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      document.cookie ...  // æ‰§è¡Œç¯å¢ƒæ£€æŸ¥åè¯¥ä»£ç ä»…ä¼šåœ¨å®¢æˆ·ç«¯æ‰§è¡Œ    ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   }")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// }")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ->")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mounted")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetchInfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("localStorage "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(" \n  document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("server.jsä¸­åŠ å…¥äº†JSDOMï¼Œä»¥åœ¨æœåŠ¡ç«¯ç¯å¢ƒä¸­æ¨¡æ‹Ÿwindowä»¥åŠdocumentç­‰å¯¹è±¡è§£å†³å·¥ç¨‹ä¸­å¤§é‡window / document is undeafinedé”™è¯¯\nä½†è¿™å¹¶éæ˜¯æœ€ä½³è§£å†³æ–¹æ¡ˆï¼Œ æ—¥å¸¸ç¼–ç ä¸­ä»ç„¶è¦æ±‚éµå®ˆç‰¹åˆ«è¯´æ˜ä¸­çš„ä½¿ç”¨è§„èŒƒ")])]),t._v(" "),a("h3",{attrs:{id:"styleæ³¨æ„äº‹é¡¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#styleæ³¨æ„äº‹é¡¹"}},[t._v("#")]),t._v(" Styleæ³¨æ„äº‹é¡¹")]),t._v(" "),a("p",[t._v("1ï¼Œè¯·å‹¿ç”»è›‡æ·»è¶³")]),t._v(" "),a("div",{staticClass:"language-css extra-class"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[t._v("<style lang="),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(" scoped>\n</>\n")])])]),a("p",[t._v("è¿™å°†å¼•èµ·ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºlangæŒ‡å®šäº†ä¸€ä¸ªç©ºçš„å­—ç¬¦ä¸²å€¼ï¼Œè¯·éµå®ˆä»¥ä¸‹çš„æ­£ç¡®ç¤ºèŒƒ")]),t._v(" "),a("div",{staticClass:"language-css extra-class"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[t._v("<style lang="),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"scss"')]),t._v(" scoped>\n</>\n<style lang="),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"css"')]),t._v(" scoped>\n</>\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* æˆ–è€… */")]),t._v("\n<style scoped>\n</>\n")])])]),a("p",[t._v("æ— æŒ‡å®šlangæ—¶ç¼–è¯‘å™¨é»˜è®¤ä¸º\"lang='css'\"")]),t._v(" "),a("h4",{attrs:{id:"å…³äºæœåŠ¡ç«¯æ•°æ®é¢„å–-seoæ ¸å¿ƒéƒ¨åˆ†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å…³äºæœåŠ¡ç«¯æ•°æ®é¢„å–-seoæ ¸å¿ƒéƒ¨åˆ†"}},[t._v("#")]),t._v(" å…³äºæœåŠ¡ç«¯æ•°æ®é¢„å–ï¼ˆSEOæ ¸å¿ƒéƒ¨åˆ†ï¼‰")]),t._v(" "),a("p",[t._v("é€šè¿‡å°†SPAæ”¹é€ æˆæœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰æˆ‘ä»¬çš„åº”ç”¨ç°åœ¨å…·å¤‡äº†åšSEOçš„åŸºç¡€ï¼ˆçˆ¬è™«å¯ä»¥è®¿é—®åˆ°å®Œæ•´çš„htmlé¡µé¢äº†ï¼‰"),a("br"),t._v("\nä½†æ˜¯æ­¤æ—¶SEOè¿˜æ²¡æœ‰å®Œæˆï¼Œæˆ‘ä»¬é™¤äº†è®©çˆ¬è™«æŠ“å–åŸºç¡€çš„htmlé¡µé¢ä¹‹å¤–ï¼Œé€šå¸¸è¿˜éœ€è¦è®©çˆ¬è™«æŠ“å–åˆ°é¡µé¢çš„å†…å®¹ï¼ˆæ¯”å¦‚æ–‡ç« è¯¦æƒ…ï¼Œå•†å“è¯¦æƒ…ç­‰ï¼‰"),a("br"),t._v("\næ‰€ä»¥æˆ‘ä»¬éœ€è¦ åœ¨htmlé¡µé¢è¾“å‡º ä¹‹å‰å°†å¯¹åº”çš„æ•°æ®åœ¨æœåŠ¡ç«¯è·å–å¹¶ä¸”æ¸²æŸ“åˆ°htmlé‡Œé¢ï¼Œå› æ­¤åœ¨SSRä¸‹æˆ‘ä»¬æš´éœ²äº†ä¸€ä¸ªæ–°çš„é’©å­ï¼š")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" title "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" commodity "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./commodity'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("asyncData")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerModule")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'commodity'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" commodity"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("all")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'commodity/fetchData'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\ncomputed"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  title"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("commodity"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mounted")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œæˆ‘ä»¬å°†asyncDataé¢„å…ˆè·å–çš„æ•°æ®æ¸²æŸ“åˆ°htmlé‡Œé¢ï¼Œè¿™æ ·çˆ¬è™«å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªå…·å¤‡å†…å®¹çš„å®Œæ•´htmläº†ã€‚")]),t._v(" "),a("h4",{attrs:{id:"é™æ€èµ„æº"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é™æ€èµ„æº"}},[t._v("#")]),t._v(" é™æ€èµ„æº")]),t._v(" "),a("p",[t._v("templateä¸­éœ€è¦åŠ¨æ€å¼•ç”¨é™æ€èµ„æºçš„åœ°æ–¹åŠ¡å¿…ä½¿ç”¨ require è¿›è¡ŒåŠ¨æ€å¼•å…¥"),a("br"),t._v("\nä¾‹å¦‚ï¼š")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"'../../../static/images/login/mm--2@2x.png'\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™æ ·å°†ä¼šå¼•èµ·èµ„æº404é”™è¯¯ï¼Œè¿›è€Œå¼•èµ·é¡µé¢404é”™è¯¯")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ­£ç¡®çš„åº”è¯¥æ˜¯ï¼š")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"require('$static/images/login/mm--2@2x.png')\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n")])])]),a("p",[t._v("å¦‚æœæ˜¯é™æ€å¼•ç”¨åˆ™ä¸éœ€è¦require"),a("br"),t._v("\nä¾‹å¦‚ï¼š")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("img src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"../../../static/images/login/mm--2@2x.png"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("è¯·æ³¨æ„åŒºåˆ†ä½¿ç”¨åœºæ™¯å¹¶åˆç†è¿ç”¨ã€‚")]),t._v(" "),a("h3",{attrs:{id:"ç¼“å­˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç¼“å­˜"}},[t._v("#")]),t._v(" ç¼“å­˜")]),t._v(" "),a("h3",{attrs:{id:"jsdom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jsdom"}},[t._v("#")]),t._v(" JSDOM")]),t._v(" "),a("h3",{attrs:{id:"å®¹ç¾"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®¹ç¾"}},[t._v("#")]),t._v(" å®¹ç¾")]),t._v(" "),a("h3",{attrs:{id:"æ³¨æ„äº‹é¡¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ³¨æ„äº‹é¡¹"}},[t._v("#")]),t._v(" æ³¨æ„äº‹é¡¹")]),t._v(" "),a("ol",[a("li",[t._v("é€šè¿‡æœåŠ¡ç«¯é¢„å–çš„æ•°æ®æ¥å£è¯·ä¸è¦æœ‰ç™»å½•æƒé™è¦æ±‚ï¼Œä¸€æ–¹é¢æ˜¯å®ç°è¿™æ ·çš„æ•ˆæœéš¾åº¦å¾ˆå¤§ï¼Œå¹¶ä¸”å†SEOéœ€æ±‚ä¹‹ä¸‹è¿™æ˜¯ä¸€ä¸ªè‡ªç›¸çŸ›ç›¾çš„å®ç°"),a("br"),t._v("\næ¯•ç«Ÿçˆ¬è™«å¯ä¸ä¼šè‡ªå·±ç™»å½•ä¹‹åå†æ¥çˆ¬å–æˆ‘ä»¬çš„ç½‘é¡µå†…å®¹ã€‚")]),t._v(" "),a("li",[t._v("ç”±äºasyncDataåªå­˜åœ¨äºè·¯ç”±ç•Œé¢ï¼Œè¿™æ„å‘³ç€ç»„ä»¶æ— æ³•é€šè¿‡asyncDataæ¥é¢„å–æ•°æ®ï¼ˆç»„ä»¶çš„å†…å®¹å°†ä¸ä¼šè¢«SEOï¼‰å¦‚æœè¦å¯¹ç»„ä»¶å†…å®¹è¿›è¡ŒSEOè¯·åœ¨"),a("br"),t._v("\nè·¯ç”±é¡µé¢asyncDataä¸‹è·å–åˆ°å…¨éƒ¨æ•°æ®å¹¶é€šè¿‡propsä¼ é€’åˆ°å­ç»„ä»¶ä¸­è¿›è¡Œæ¸²æŸ“ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"ç–‘éš¾æ‚ç—‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç–‘éš¾æ‚ç—‡"}},[t._v("#")]),t._v(" ç–‘éš¾æ‚ç—‡")]),t._v(" "),a("p",[t._v("ğŸ› Error: Not implemented: window.scrollTo undefined\nä¸Šè¾ˆå­è¢«è¿™ä¸ªæŠ¥é”™æ°”æ­»æ‰ï¼ˆè™½ç„¶ä¸æ˜¯ä»€ä¹ˆä¼šå¯¼è‡´ç¨‹åºç»ˆæ­¢çš„Bugï¼Œä½†æ¯æ¬¡éƒ½æŠ¥é”™çœ‹ç€éå¸¸çƒ¦ï¼‰"),a("br"),t._v("\nåŸå› åœ¨äºSSRä¸‹ä¸æ”¯æŒvue-routerçš„scrollBehaviorè¡Œä¸ºï¼Œæ³¨é‡Šæ‰å³å¯ã€‚"),a("br"),t._v("\néè¦ç”¨æ€ä¹ˆåŠï¼Ÿ"),a("br"),t._v("\nç›®å‰æš‚æ—¶æ— è§£ï¼Œå®˜æ–¹ä¹Ÿæ²¡æœ‰ç»™å‡ºè¿™ä¸ªé—®é¢˜çš„å›ç­”æˆ–è€…è§£å†³åŠæ³•ã€‚"),a("br"),t._v("\nå¦‚æœä½ æœ‰ä»€ä¹ˆå¥½çš„è§£å†³åŠæ³•ï¼Œ please fix me ğŸ˜•")]),t._v(" "),a("p",[t._v("ğŸ› 404 Page Not Found\næ³¨è§£ï¼šé€šå¸¸ç”±äºå„ç±»ä¸¥é‡çš„ä»£ç /é€»è¾‘é”™è¯¯å¯¼è‡´Node.js serverè¿è¡Œé”™è¯¯ï¼Œå¸¸è§äºç”¨æˆ·åˆ·æ–°é¡µé¢å404ï¼Œå†æ¬¡åˆ·æ–°æ­£å¸¸ï¼Œä»¥æ­¤åå¤ã€‚ã€‚\nå½±å“ç¨‹åº¦ï¼š ç¾éš¾æ€§åæœï¼Œå¯¼è‡´åº”ç”¨ç¨‹åºæ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚\nè§£å†³åŠæ³•ï¼š ä¸¥æ ¼å¯¹å¾…è‡ªå·±æ•²ä¸‹çš„æ¯ä¸€è¡Œä»£ç å¹¶å¯¹å…¶åå¤è°ƒè¯•å’ŒéªŒè¯ï¼Œå¯¹äºæŸäº›æƒ…å†µä¸‹ä½¿ç”¨çƒ­é‡è½½è°ƒè¯•å¹¶ä¸èƒ½å¾—åˆ°å‡†ç¡®çš„éªŒè¯ç»“æœï¼Œéœ€è¦\né‡æ–°æ‰§è¡Œnpm run serveç¼–è¯‘è¿è¡Œã€‚\n"),a("code",[t._v("[Vue warn]: The client-side rendered virtual DOM tree is not matching server-rendered content. This is likely caused by incorrect HTML markup, for example nesting block-level elements inside <p>, or missing <tbody>. Bailing hydration and performing full client-side render.")]),t._v("\næ³¨è§£ï¼šç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯SSRæ··åˆæ¨¡å¼ï¼ˆæœåŠ¡ç«¯æ¸²æŸ“è¾“å‡ºhtmlé¡µé¢åï¼Œå®¢æˆ·ç«¯è¿›è¡ŒæŒ‚è½½æ¿€æ´»ï¼Œè¿™æ ·å¯é¿å…æ•°æ®é‡å¤è·å–ï¼ŒåŠ å¿«é€Ÿåº¦ï¼‰ å½“å‡ºç°æ­¤æŠ¥é”™æ—¶è¯´æ˜å®¢æˆ·ç«¯çš„DOMæ ‘ä¸æœåŠ¡ç«¯æ¸²æŸ“çš„å†…å®¹ä¸ä¸€è‡´ï¼Œå¯¼è‡´æ··åˆå¤±è´¥ï¼Œç¨‹åºå°†è‡ªåŠ¨è¿›è¡Œå®¢æˆ·ç«¯å®Œå…¨æ¸²æŸ“ã€‚å…¸å‹çš„ç—‡çŠ¶æ˜¯ï¼Œåœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸‹å…·æœ‰æ£€æµ‹åŒç«¯èŠ‚ç‚¹ä¸€è‡´æ€§çš„åŠŸèƒ½ï¼Œæ··åˆå¤±è´¥æƒ…å†µä¸‹é¡µé¢ä»å¯æ­£å¸¸è¿è¡Œï¼ˆè‡ªåŠ¨è¿›è¡Œå®¢æˆ·ç«¯å®Œå…¨æ¸²æŸ“ï¼‰ ä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œæ£€æµ‹åŒç«¯èŠ‚ç‚¹ä¸€è‡´æ€§å›å¤§é‡æŸè€—æœåŠ¡å™¨æ€§èƒ½ï¼Œæ‰€ä»¥vue-server-renderåœ¨ç”Ÿäº§æ¨¡å¼ä¸‹æ˜¯å…³é—­çš„ï¼Œè¿™å°†å¯¼è‡´å®¢æˆ·ç«¯å¹¶æ²¡æœ‰é‡æ–°æ¸²æŸ“æœåŠ¡ç«¯è¾“å‡ºçš„é”™è¯¯HTMLï¼Œå¯¼è‡´é¡µé¢æ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚")]),t._v(" "),a("p",[t._v("æ‰€ä»¥å½“æ§åˆ¶å°æŠ›å‡ºæ­¤é”™è¯¯æ—¶ä¸€å®šè¦é‡è§†ï¼Œä¸èƒ½å› ä¸ºåœ¨å¼€å‘ç¯å¢ƒä¸‹è¿è¡Œæ­£å¸¸å°±è®¤å®šä¸ºå¯å‘å¸ƒç”Ÿäº§ï¼ï¼")]),t._v(" "),a("ol",[a("li",[t._v("HTMLä»£ç ç¼–å†™ä¸è§„èŒƒï¼Œå¯¼è‡´å‡ºç°æ— æ•ˆçš„HTMLã€‚")]),t._v(" "),a("li",[t._v("HTMLä¸­ç”¨åˆ°äº†æŸäº›v-ifç­‰æ¡ä»¶æ§åˆ¶ï¼Œåœ¨ç‰¹å®šçš„æƒ…å†µä¸‹å¯¼è‡´ä¸¤ç«¯æ¸²æŸ“ä¸åŒ¹é…è€Œå¼•èµ·ã€‚\nå½±å“ç¨‹åº¦ï¼š ç¾éš¾æ€§åæœï¼Œå¯¼è‡´æ§åˆ¶å°è¾“å‡ºå¼‚å¸¸è­¦å‘Šï¼Œåœ¨ç”Ÿäº§æ¨¡å¼ä¸‹é¡µé¢æ— æ³•æ­£å¸¸è¿è¡Œï¼Œè¿›è€Œå¤§æ¦‚ç‡æŠ›å‡º404é¡µé¢ã€‚\nè§£å†³åŠæ³•ï¼š ä¸¥æ ¼éµå®ˆHTMLæ ‡ç­¾è¯­æ³•æ ‡å‡†å’Œä¼˜ç§€çš„ç¼–ç ä¹ æƒ¯ï¼ˆè¿™æ˜¯é‡ç‚¹ï¼‰ï¼Œå°½é‡é¿å…ä½¿ç”¨v-ifï¼ˆv-ifä¸ºfalseæ—¶å°†æ— å¯¹åº”DOMèŠ‚ç‚¹ï¼‰,ç›¸å…³éœ€æ±‚è¯·ç”¨v-showè¿›è¡Œä»£æ›¿ã€‚")]),t._v(" "),a("li",[t._v("Promiseå‡½æ•°å¿…é¡»è¦è°ƒç”¨åˆ°resolveå’Œreject")])]),t._v(" "),a("p",[t._v("é—®é¢˜å»¶ä¼¸ï¼š å‡ºç°è¿™ä¸ªé”™è¯¯ä¸€èˆ¬æœåŠ¡ç«¯éƒ¨åˆ†æ¸²æŸ“å·²ç»å‡ºç°äº†é—®é¢˜ï¼Œæ­¤æƒ…å†µåœ¨å¼€å‘æ¨¡å¼å¯èƒ½æ— æ³•å¯Ÿè§‰ï¼Œéœ€è¦æ‰“åŒ…ä¹‹åä½¿ç”¨ç”Ÿäº§æ¨¡å¼æ‰èƒ½çœ‹åˆ°æœåŠ¡ç«¯çš„å…·ä½“æŠ¥é”™ä¿¡æ¯"),a("br"),t._v("\næ¡ˆä¾‹ï¼š http://mirror.relaysogo.com/productMatch/resultä¸‹å‡ºç°å¦‚ä¸‹é”™è¯¯: "),a("br")]),t._v(" "),a("blockquote",[a("p",[t._v("DOMException: Failed to execute 'appendChild' on 'Node': This node type does not support this method."),a("br"),t._v("\nç»ˆæè§£å†³åŠæ³•ï¼š å‡è®¾ç»è¿‡æ’æŸ¥ã€ä»£ç ä¼˜åŒ–ä¹‹åä»ç„¶å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œè¯·ä½¿ç”¨"),a("code",[t._v("<client-only></client-only>")]),t._v("è¿›è¡ŒåŒ…è£¹ï¼Œè¿™ä¸€æ¥èŒƒå›´å†…ç»„ä»¶ä»…ä¼šåœ¨å®¢æˆ·ç«¯è¿›è¡Œæ¸²æŸ“ã€‚")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("client"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("only"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("shit"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("what the fuck"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("shit"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("client"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("only"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("å¦‚æ­¤ä¸€æ¥ï¼Œ"),a("code",[t._v("<shit>")]),t._v("ä»…ä¼šåœ¨å®¢æˆ·ç«¯ä¸‹è¿›è¡Œæ¸²æŸ“ï¼Œä¸ä¼šåœ¨æœåŠ¡ç«¯é€ æˆç¾éš¾æ€§åæœã€‚\nasyncData æ¥å£ä»£ç†é—®é¢˜")]),t._v(" "),a("ol",[a("li",[t._v("åœ¨æœ¬åœ°å¼€å‘æ¨¡å¼ä¸‹ï¼Œé€šè¿‡node http-proxy-middlewareä¸­é—´ä»¶è¿›è¡Œä»£ç†è½¬å‘ï¼Œå¯ä»¥å®ç°å®¢æˆ·ç«¯è¯·æ±‚ï¼ˆajaxï¼‰ä¸æœåŠ¡ç«¯è¯·æ±‚ï¼ˆserver pre-fetchï¼‰æ‰€éœ€è¦çš„æ¥å£ä»£ç†ã€‚ç„¶è€Œå‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒæ—¶æœåŠ¡ç«¯è¯·æ±‚ä»…åœ¨é¦–å±æ¸²æŸ“æ—¶æœ‰æ•ˆï¼Œå…¶ä½™ä»»ä½•éœ€è¦asyncDataé’©å­è¿›è¡Œæ•°æ®é¢„å–çš„åœºæ™¯å‡ä¸ºå¯¼è‡´è·¨åŸŸé—®é¢˜ã€‚"),a("br"),t._v("\nå…·ä½“é—®é¢˜çš„äº§ç”Ÿå¤„åœ¨entry-clientå…³äºrouter hook for handling asyncDataå¤„ã€‚æ·±ç©¶åŸå› å¦‚ä¸‹ï¼š"),a("br"),t._v("\nï¼ˆ1ï¼‰ é¦–å±æ¸²æŸ“æ—¶asyncDataç”±æœåŠ¡ç«¯è§¦å‘ï¼Œnode serverè¿›è¡Œæ•°æ®é¢„å–ï¼Œä¸å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Œæ‰€ä»¥é¦–å±æ¸²æŸ“æ•°æ®æ¸²æŸ“æ­£å¸¸ã€‚\nï¼ˆ2ï¼‰ è·¯ç”±å˜åŒ–æ—¶asyncDataç”±å®¢æˆ·ç«¯è§¦å‘ï¼Œæµè§ˆå™¨è¿›è¡Œæ•°æ®é¢„å–ï¼Œhttp-proxy-middleware æ­¤åˆ»ä¸ç”Ÿæ•ˆè¿›è€Œå¯¼è‡´å‘ç”Ÿæ¥å£è·¨åŸŸé—®é¢˜ã€‚"),a("br"),t._v("\nè‡³äºä¸ºä½•é’ˆå¯¹asyncDataçš„æ¥å£è¯·æ±‚ä»£ç†å¤±è´¥çš„åŸå› ç›®å‰æ— è§£ï¼Œç½‘ä¸Šå‡æ— ç›¸å…³èµ„æ–™ã€‚"),a("br"),t._v("\nä¸è¿‡æ—¢ç„¶é—®é¢˜æ˜¯æ¥å£è·¨åŸŸï¼Œé‚£ä¹ˆé—®é¢˜çš„è§£å†³åŠæ³•æœ‰ä¸¤ç§ï¼š\né¦–å…ˆæ­¤å¤„è·¨åŸŸé—®é¢˜æ˜¯ç”±äºPOSTå¤æ‚è¯·æ±‚æ²¡æœ‰é€šè¿‡åå°è¯·æ±‚é¢„æ£€ï¼ˆoptionsï¼‰")]),t._v(" "),a("li",[t._v("æœåŠ¡ç«¯é…ç½®CORSç­–ç•¥ï¼Œå…è®¸æ‰€æœ‰/ç›®æ ‡ä½œç”¨åŸŸé€šè¿‡ã€‚")]),t._v(" "),a("li",[t._v("ä½¿ç”¨ä»£ç†è¿›è¡Œæ¥å£è½¬å‘ã€‚\nä¸Šé¢æˆ‘ä»¬ä½¿ç”¨äº† node http-proxy-middlewareä¸­é—´ä»¶å¹¶ä¸èƒ½è§£å†³æ‰€æœ‰åœºæ™¯ä¸‹çš„æ¥å£è½¬å‘é—®é¢˜ï¼Œ ç»è¿‡ä¸€ç•ªæŠ˜è…¾æœ€åé€‰æ‹©ç”¨nginx"),a("br"),t._v("\nå…·ä½“çš„é…ç½®è¿‡ç¨‹å‚è€ƒä¸‹æ–¹è¯¦ç»†æè¿°ï¼ˆå¼€å‘æ¨¡å¼ä¸‹æ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒï¼‰ã€‚")])]),t._v(" "),a("h4",{attrs:{id:"åˆ—ä¸¾çš„ä¸šåŠ¡åŠŸèƒ½é‡æ„éƒ¨åˆ†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆ—ä¸¾çš„ä¸šåŠ¡åŠŸèƒ½é‡æ„éƒ¨åˆ†"}},[t._v("#")]),t._v(" åˆ—ä¸¾çš„ä¸šåŠ¡åŠŸèƒ½é‡æ„éƒ¨åˆ†")]),t._v(" "),a("ol",[a("li",[t._v("å…³äºVue.prototype.isClick"),a("br"),t._v("\næ­¤éƒ¨åˆ†ç”¨äºé™åˆ¶ç”¨æˆ·åŠ¨ä½œçš„æƒé™æ§åˆ¶é€»è¾‘è¿›è¡Œäº†å¦‚ä¸‹æ›´æ”¹ï¼š")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// entry-client.js")]),t._v("\n  router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onReady")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("currentRoute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Add router hook for handling asyncData.")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Doing it after initial route is resolved so that we don't double-fetch")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// the data that we already have. Using router.beforeResolve() so that all")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// async components are resolved.")]),t._v("\n  router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("beforeResolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¯æ¬¡è·¯ç”±resolveä¹‹å‰æ£€æŸ¥å¯æ“ä½œæƒé™ï¼Œæ¯æ¬¡è·¯ç”±å˜åŒ–éƒ½ä¼šæ£€æŸ¥ä¸€æ¬¡ç”¨æˆ·ç™»å½•çŠ¶æ€")]),t._v("\n    store"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'checkOperationPerms'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// çœç•¥å…¶ä½™æ— å…³ä»£ç ....")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// store/modules/user.js")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkOperationPerms")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" commit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rootState "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("rootState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isClick "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isClick "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ç»æµ‹è¯•ï¼Œè¯¥åŠŸèƒ½ç›®å‰è¿è¡Œè¾ƒä¸ºç¨³å®šã€‚")])])}),[],!1,null,null,null);s.default=e.exports}}]);